{% extends "Base.html" %}

{% block title %}Nos Produits{% endblock %}

{% block css %}
<link rel="stylesheet" href="{{url_for('static', filename = 'CSS/products.css')}}">
{% endblock %}

{% block content %}
<div class="products-container">
    <!-- Hero Section -->
    <div class="products-hero">
        <h1 class="products-title">Nos Produits</h1>
        <p class="products-subtitle">Découvrez notre sélection de produits de qualité</p>
    </div>

    <!-- Filters and Search Section -->
    <section class="filters-section">
        <div class="filters-container">
            <div class="search-box">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.35-4.35"></path>
                </svg>
                <input type="text" id="searchInput" placeholder="Rechercher un produit...">
            </div>
            
            <div class="filter-options">
                <select id="sortFilter" class="filter-select">
                    <option value="">Trier par</option>
                    <option value="price-asc">Prix croissant</option>
                    <option value="price-desc">Prix décroissant</option>
                    <option value="name-asc">Nom (A-Z)</option>
                    <option value="name-desc">Nom (Z-A)</option>
                </select>
                
                <select id="categoryFilter" class="filter-select">
                    <option value="">Toutes les categories</option>
                    <option value="electronique">Électronique</option>
                    <option value="vetements">Nourriture</option>
                    <option value="maison">Cosmétiques</option>
                    <option value="sport">Location véhicule</option>
                </select>
            </div>
        </div>
    </section>

    <!-- Products Grid -->
    <section class="products-section">
        {% if products %}
            <div class="products-grid" id="productsGrid">
                {% for product in products %}
                    <div class="product-card" data-product-name="{{product.name}}" data-product-price="{{product.price}}">
                        <div class="product-image">
                            {% if product.image_url %}
                                <img src="{{product.image_url}}" alt="{{product.name}}">
                            {% else %}
                                <div class="product-placeholder">
                                    <svg width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                        <circle cx="8.5" cy="8.5" r="1.5"></circle>
                                        <polyline points="21 15 16 10 5 21"></polyline>
                                    </svg>
                                </div>
                            {% endif %}
                            <div class="product-badge">Nouveau</div>
                        </div>
                        
                        <div class="product-info">
                            <h3 class="product-name">{{product.name}}</h3>
                            <p class="product-description">{{product.description}}</p>
                            
                            <div class="product-rating">
                                <div class="stars">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                    </svg>
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                    </svg>
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                    </svg>
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                    </svg>
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                    </svg>
                                </div>
                                <span class="rating-count">(45)</span>
                            </div>
                            
                            <div class="product-footer">
                                <div class="product-price">
                                    <span class="price">{{product.price}} FCFA</span>
                                </div>
                                
                                <div class="product-actions">
                                    <a href="#" class="btn-view" title="Voir le produit">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                            <circle cx="12" cy="12" r="3"></circle>
                                        </svg>
                                    </a>
                                    <a href="{{url_for('cart.add_to_cart', id=product.id)}}" class="btn-cart" title="Ajouter au panier">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <circle cx="9" cy="21" r="1"></circle>
                                            <circle cx="20" cy="21" r="1"></circle>
                                            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                                        </svg>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="no-products">
                <svg width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="12"></line>
                    <line x1="12" y1="16" x2="12.01" y2="16"></line>
                </svg>
                <h2>Aucun produit disponible</h2>
                <p>Revenez plus tard pour découvrir nos nouveaux produits.</p>
                <a href="{{url_for('main.index')}}" class="btn-home">Retour à l'accueil</a>
            </div>
        {% endif %}
    </section>

    <!-- Newsletter CTA -->
    <section class="newsletter-cta">
        <h2>Restez informé de nos nouveautés</h2>
        <p>Inscrivez-vous à notre newsletter et recevez nos meilleures offres en exclusivité</p>
        <form class="newsletter-cta-form">
            <input type="email" placeholder="Votre adresse email" required>
            <button type="submit">S'inscrire</button>
        </form>
    </section>
</div>

<script>
    // Recherche de produits en temps réel
    const searchInput = document.getElementById('searchInput');
    const productCards = document.querySelectorAll('.product-card');

    searchInput.addEventListener('input', (e) => {
        const searchTerm = e.target.value.toLowerCase();
        
        productCards.forEach(card => {
            const productName = card.dataset.productName.toLowerCase();
            if (productName.includes(searchTerm)) {
                card.style.display = 'block';
            } else {
                card.style.display = 'none';
            }
        });
    });

    // Tri des produits
    const sortFilter = document.getElementById('sortFilter');
    const productsGrid = document.getElementById('productsGrid');

    sortFilter.addEventListener('change', (e) => {
        const sortValue = e.target.value;
        const cardsArray = Array.from(productCards);

        if (sortValue === 'price-asc') {
            cardsArray.sort((a, b) => parseFloat(a.dataset.productPrice) - parseFloat(b.dataset.productPrice));
        } else if (sortValue === 'price-desc') {
            cardsArray.sort((a, b) => parseFloat(b.dataset.productPrice) - parseFloat(a.dataset.productPrice));
        } else if (sortValue === 'name-asc') {
            cardsArray.sort((a, b) => a.dataset.productName.localeCompare(b.dataset.productName));
        } else if (sortValue === 'name-desc') {
            cardsArray.sort((a, b) => b.dataset.productName.localeCompare(a.dataset.productName));
        }

        cardsArray.forEach(card => productsGrid.appendChild(card));
    });
</script>
{% endblock %}
