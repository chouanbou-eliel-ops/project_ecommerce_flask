{% extends "Base.html" %}

{% block title %}Mon Panier{% endblock %}

{% block css %}
<link rel="stylesheet" href="{{url_for('static', filename = 'CSS/cart.css')}}">
{% endblock %}

{% block content %}
<div class="cart-container">
    <!-- Hero Section -->
    <div class="cart-hero">
        <h1 class="cart-title">Mon Panier</h1>
        <p class="cart-subtitle">Vérifiez vos articles avant de procéder au paiement</p>
    </div>

    <div class="cart-content">
        {% if products and products|length > 0 %}
            <!-- Cart Items Section -->
            <div class="cart-items-section">
                <div class="cart-header">
                    <h2>Articles dans votre panier ({{ products|length }})</h2>
                    <a href="{{ url_for('cart.clear_cart') }}" class="clear-cart-btn" onclick="return confirm('Êtes-vous sûr de vouloir vider votre panier ?')">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="3 6 5 6 21 6"></polyline>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                        </svg>
                        Vider le panier
                    </a>
                </div>

                <div class="cart-items">
                    {% for item in products %}
                        <div class="cart-item">
                            <div class="item-image">
                                {% if item.product.image_url %}
                                    <img src="{{ item.product.image_url }}" alt="{{ item.product.name }}">
                                {% else %}
                                    <div class="item-placeholder">
                                        <svg width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                            <circle cx="8.5" cy="8.5" r="1.5"></circle>
                                            <polyline points="21 15 16 10 5 21"></polyline>
                                        </svg>
                                    </div>
                                {% endif %}
                            </div>

                            <div class="item-details">
                                <h3 class="item-name">{{ item.product.name }}</h3>
                                <p class="item-description">{{ item.product.description }}</p>
                                <div class="item-meta">
                                    <span class="item-price">{{ item.product.price }} FCFA</span>
                                    <span class="item-stock">En stock</span>
                                </div>
                            </div>

                            <div class="item-quantity">
                                <label>Quantité</label>
                                <div class="quantity-controls">
                                    <button class="qty-btn qty-minus" data-product-id="{{ item.product.id }}">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <line x1="5" y1="12" x2="19" y2="12"></line>
                                        </svg>
                                    </button>
                                    <input type="number" class="qty-input" value="{{ item.quantité }}" min="1" max="99" readonly>
                                    <button class="qty-btn qty-plus" data-product-id="{{ item.product.id }}">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <line x1="12" y1="5" x2="12" y2="19"></line>
                                            <line x1="5" y1="12" x2="19" y2="12"></line>
                                        </svg>
                                    </button>
                                </div>
                            </div>

                            <div class="item-subtotal">
                                <label>Sous-total</label>
                                <span class="subtotal-price">{{ item.subtotal }} FCFA</span>
                            </div>

                            <div class="item-actions">
                                <a href="{{ url_for('cart.remove_from_cart', id=item.product.id) }}" class="remove-btn" title="Retirer du panier" onclick="return confirm('Retirer cet article du panier ?')">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <line x1="18" y1="6" x2="6" y2="18"></line>
                                        <line x1="6" y1="6" x2="18" y2="18"></line>
                                    </svg>
                                </a>
                            </div>
                        </div>
                    {% endfor %}
                </div>

                <!-- Continue Shopping -->
                <div class="continue-shopping">
                    <a href="{{ url_for('main.products') }}" class="continue-btn">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="19" y1="12" x2="5" y2="12"></line>
                            <polyline points="12 19 5 12 12 5"></polyline>
                        </svg>
                        Continuer mes achats
                    </a>
                </div>
            </div>

            <!-- Cart Summary Section -->
            <div class="cart-summary-section">
                <div class="summary-card">
                    <h3>Résumé de la commande</h3>
                    
                    <div class="summary-row">
                        <span>Sous-total</span>
                        <span>{{ total }} FCFA</span>
                    </div>
                    
                    <div class="summary-row">
                        <span>Livraison</span>
                        <span class="free-shipping">Gratuite</span>
                    </div>
                    
                    <div class="summary-row">
                        <span>TVA (18%)</span>
                        <span>{{ (total * 0.18)|round(2) }} FCFA</span>
                    </div>
                    
                    <div class="summary-divider"></div>
                    
                    <div class="summary-total">
                        <span>Total</span>
                        <span class="total-amount">{{ (total * 1.18)|round(2) }} FCFA</span>
                    </div>

                    <a href="#" class="checkout-btn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
                            <line x1="1" y1="10" x2="23" y2="10"></line>
                        </svg>
                        Procéder au paiement
                    </a>

                    <!-- Trust Badges -->
                    <div class="trust-badges">
                        <div class="badge-item">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                                <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                            </svg>
                            <span>Paiement sécurisé</span>
                        </div>
                        <div class="badge-item">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                                <circle cx="12" cy="10" r="3"></circle>
                            </svg>
                            <span>Livraison rapide</span>
                        </div>
                        <div class="badge-item">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                <polyline points="22 4 12 14.01 9 11.01"></polyline>
                            </svg>
                            <span>Satisfait ou remboursé</span>
                        </div>
                    </div>
                </div>

                <!-- Promo Code -->
                <div class="promo-card">
                    <h4>Code promo</h4>
                    <form class="promo-form">
                        <input type="text" placeholder="Entrez votre code" name="promo_code">
                        <button type="submit">Appliquer</button>
                    </form>
                </div>
            </div>

        {% else %}
            <!-- Empty Cart State -->
            <div class="empty-cart">
                <svg width="120" height="120" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                    <circle cx="9" cy="21" r="1"></circle>
                    <circle cx="20" cy="21" r="1"></circle>
                    <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                </svg>
                <h2>Votre panier est vide</h2>
                <p>Vous n'avez pas encore ajouté d'articles à votre panier.</p>
                <a href="{{ url_for('main.products') }}" class="shop-now-btn">
                    Découvrir nos produits
                </a>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}